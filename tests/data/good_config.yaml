%YAML 1.2
---
application:
  poll_interval: 10.0
  # sentry_dsn: https://[YOUR-SENTRY-DSN]
  stats:
    log: True
    influxdb:
      enabled: False
      scheme: http
      host: influxdb
      port: 8086
      user: influxdb
      password: foo
      database: bar
    statsd:
      enabled: False
      host: localhost
      port: 8125
      prefix: application.rejected
  connections:
    rabbitmq:
      hostname: rabbitmq.server.local
      port: 5672
      username: rejected
      password: rabbits
      ssl: False
      virtual_host: /
      heartbeat_interval: 60
      qos_prefetch: 10
      definitions:
        bindings:
          - arguments: {}
            destination: test
            destination_type: queue
            routing_key: test.messages
            source: test
        exchanges:
          - arguments: {}
            auto_delete: false
            durable: true
            name: test
            type: topic
        queues:
          - arguments: {}
            auto_delete: false
            durable: true
            name: test
    rabbitmq2:
      hostname: localhost
      port: 5672
      username: rejected
      password: rabbitmq
      ssl: False
      virtual_host: /
      heartbeat_interval: 60
      qos_prefetch: 100
      definitions:
        bindings: []
        exchanges: []
        queues: []
  consumers:
    async:
      class: examples.AsyncExampleConsumer
      connections:
        - rabbitmq
        - name: rabbitmq2
          consume: False
          confirm: False
      qty: 1
      queue: test
      ack: True
      max_errors: 100

    sync:
      class: examples.ExampleConsumer
      connections:
        - rabbitmq
        - name: rabbitmq2
          consume: False
      qty: 2
      queue: generated_messages
      ack: True
      max_errors: 100
      error_exchange: errors
      config:
        foo: True
        bar: baz

daemon:
  user: rejected
  group: daemon
  pidfile: /var/run/rejected.pid

logging:
  version: 1
  formatters:
    verbose:
      format: "%(levelname) -10s %(asctime)s %(process)-6d %(processName) -15s %(name) -20s %(funcName) -20s: %(message)s"
      datefmt: "%Y-%m-%d %H:%M:%S"
    verbose_correlation:
      format: "%(levelname) -10s %(asctime)s %(process)-6d %(processName) -15s %(name) -20s %(funcName) -20s: %(message)s {CID %(correlation_id)s}"
      datefmt: "%Y-%m-%d %H:%M:%S"
    syslog:
      format: "%(levelname)s <PID %(process)d:%(processName)s> %(name)s.%(funcName)s: %(message)s"
    syslog_correlation:
      format: "%(levelname)s <PID %(process)d:%(processName)s> %(name)s.%(funcName)s: %(message)s {CID %(correlation_id)s)"
  filters:
    correlation:
      '()': rejected.logging.CorrelationFilter
      'exists': True
    no_correlation:
      '()': rejected.logging.CorrelationFilter
      'exists': False
  handlers:
    console:
      class: logging.StreamHandler
      formatter: verbose
      filters: [no_correlation]
    console_correlation:
      class: logging.StreamHandler
      formatter: verbose_correlation
      filters: [correlation]
    syslog:
      class: logging.handlers.SysLogHandler
      facility: daemon
      address: /var/run/syslog
      formatter: syslog
      filters: [no_correlation]
    syslog_correlation:
      class: logging.handlers.SysLogHandler
      facility: daemon
      address: /var/run/syslog
      formatter: syslog
      filters: [correlation]
  loggers:
    rejected:
      level: INFO
      propagate: false
      handlers: [console, console_correlation, syslog, syslog_correlation]
    rejected.consumer:
      level: INFO
      propagate: false
      handlers: [console, console_correlation, syslog, syslog_correlation]
    rejected.mcp:
      level: DEBUG
      propagate: false
      handlers: [console, console_correlation, syslog, syslog_correlation]
    rejected.process:
      level: DEBUG
      propagate: false
      handlers: [console, console_correlation, syslog, syslog_correlation]
    rejected.state:
      level: DEBUG
      propagate: false
      handlers: [console, console_correlation, syslog, syslog_correlation]
  disable_existing_loggers: true
  incremental: false
